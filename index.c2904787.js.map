{"mappings":"iiBACA,IAAAA,EAAAC,EAAA,S,uCCDMC,EAAuB,WAEtB,SAASC,EAAmBC,GACjCC,QAAQC,IAAIF,GACZ,IACE,IAAIG,EAAeC,IAWnB,MAT0B,iBAAjBD,IACyB,IAAhCE,MAAMC,QAAQH,KAEdA,EAAe,GACfF,QAAQC,IAAIC,IAGdA,EAAaI,QAAQP,GACrBQ,EAAcL,IACP,C,CACP,MAAOM,GAEP,OADAR,QAAQQ,MAAMA,EAAMC,UACb,C,EAIJ,SAASC,EAAmBC,GACjC,IACE,IAAMT,EAAeC,IACfS,EAAaV,EAAaW,WAAU,SAACC,EAAKC,G,OAAQD,EAAIE,KAAOL,C,IAGnE,OAFAT,EAAae,OAAOL,EAAY,GAChCL,EAAcL,IACP,C,CACP,MAAOM,GAEP,OADAR,QAAQQ,MAAMA,EAAMC,UACb,C,EAIJ,SAASF,EAAcW,GAC5B,IAAMC,EAAM,sDACZ,GAAmB,iBAARD,EAIX,IAA2B,IAAvBd,MAAMC,QAAQa,GAIlB,IACE,IAAME,EAAkBC,KAAKC,UAAUJ,GACvCK,aAAaC,QAAQ3B,EAAsBuB,E,CAC3C,MAAOZ,GACPR,QAAQQ,MAAM,oBAAqBA,EAAMC,Q,MAPzCT,QAAQC,IAAIkB,QAJZnB,QAAQC,IAAIkB,E,CAeT,SAAShB,IACd,IACE,IAAMiB,EAAkBG,aAAaE,QAAQ5B,GAC7C,OAA2B,OAApBuB,OAA2BM,EAAYL,KAAKM,MAAMP,E,CACzD,MAAOZ,GACPR,QAAQQ,MAAMA,EAAMC,Q,EDnDxB,IAAMmB,EAAMC,SAASC,cAAc,aAEnCF,EAAIG,iBAAiB,SENrB,SAA0BC,GACxB,GAAIA,EAAEC,OAAOC,QAAQ,UAAW,CAC9B,IAAMC,EAAYH,EAAEC,OAAOC,QAAQ,UAC7BE,EAAQD,EAAUD,QAAQ,MAAMG,QAAQrB,GACxCsB,EAAOH,EAAUL,cAAc,yBACtBK,EAAUL,cAAc,2BAEnCK,EAAUI,UAAUC,SAAS,YAQrC,SAAqBL,EAAWC,EAAOE,EAAMG,G,IACtCC,GAAQ,EAARC,GAAQ,EAARC,OAAQlB,E,IAAb,QAAKmB,EAAAC,EAAYC,IAAUC,OAAAC,cAAtBP,GAAAG,EAAAC,EAAQI,QAAAC,MAART,GAAQ,GAAR,IAAMU,EAANP,EAAQQ,MACX,GAAID,EAAGpC,KAAOoB,EASZ,YARkB1B,EAAmB0C,EAAGpC,MAItChB,QAAQC,IAAI,UACNkC,EAAII,UAAUe,OAAO,YAC3BhB,EAAKiB,YAAc,mB,WARpBZ,GAAQ,EAARC,EAAQY,C,aAARd,GAAQ,MAARI,EAAQW,QAARX,EAAQW,Q,YAARd,E,MAAAC,C,GARDc,CAAYvB,EAAWC,EAAOE,GAuB7B,SAAoBH,EAAWC,EAAOE,EAAMG,G,IAC5CC,GAAQ,EAARC,GAAQ,EAARC,OAAQlB,E,IAAb,QAAKmB,EAAAC,EAAYC,IAAUC,OAAAC,cAAtBP,GAAAG,EAAAC,EAAQI,QAAAC,MAART,GAAQ,GAAR,IAAMU,EAANP,EAAQQ,MACX,GAAID,EAAGpC,KAAOoB,EASZ,YARkBtC,EAAmBsD,KAInCpD,QAAQC,IAAI,WACZkC,EAAUI,UAAUoB,IAAI,YACxBrB,EAAKiB,YAAc,wB,WARpBZ,GAAQ,EAARC,EAAQY,C,aAARd,GAAQ,MAARI,EAAQW,QAARX,EAAQW,Q,YAARd,E,MAAAC,C,GAtBDgB,CAAWzB,EAAWC,EAAOE,E,KFHnCV,EAAIG,iBAAiB,SA+HrB,SAAyBC,GAEvB,GADAA,EAAE6B,iBACuB,MAArB7B,EAAEC,OAAO6B,QAAiB,CAC5B,IAAIC,EAAY/B,EAAEC,OAAOC,QAAQ,MAAMG,QAAQrB,GAC3CgD,EAAYhC,EAAEC,OAAOC,QAAQ,MAG5BQ,GAAQ,EAARC,GAAQ,EAARC,OAAQlB,E,IAAb,QAAKmB,EAAAC,EAAYmB,EAAcjB,OAAAC,cAA1BP,GAAAG,EAAAC,EAAQI,QAAAC,MAART,GAAQ,EAAoB,CAA5B,IAAMU,EAANP,EAAQQ,MAEX,GADArD,QAAQC,IAAI,QAASmD,GACjBA,EAAGpC,KAAO+C,EAIZ,OAFA/D,QAAQC,IAAI,uDACQ+D,EAAVzB,UAAUoB,IAAI,QAG1B3D,QAAQC,IAAI,0C,WART0C,GAAQ,EAARC,EAAQY,C,aAARd,GAAQ,MAARI,EAAQW,QAARX,EAAQW,Q,YAARd,E,MAAAC,C,OApIT,IAAIsB,EAAsBC,IACtBF,EAAiB,GAEjBG,EAAU,K,SAUCC,EAAqBC,G,OAArBC,EAAoBC,MAAAC,KAAAC,U,UAApBH,I,OAAAA,EAAfI,EAAAhF,EAAA,CAAAgF,EAAAC,GAAAC,MAAA,SAAAC,EAAoCR,G,IAW5BS,EAGFC,EAIKC,E,qEAATA,EAAA,SAAgB/D,GAEd,IAAMgE,EAAW/E,IACFe,EAAIiE,SAAQ,SAAA/B,GACX8B,EAASE,MAAK,SAAAC,G,OAAQjC,EAAGpC,KAAOqE,EAAKrE,E,KAEjDoC,EAAGO,KAAM,EACTqB,EAAMM,KAAKlC,KAEXA,EAAGO,KAAM,EACTqB,EAAMM,KAAKlC,G,KAzBa,IAA1Ba,EAAesB,OAAY,C,+BACNjB,I,OAAvBL,EAAcuB,EAAAC,K,OAKhBrB,EAAUsB,IAEJX,EAAeY,EAAa1B,EAtBzB,EAsB+CG,GAGpDY,EAAQ,GAEZC,EAAOF,GA8BsCa,EAbvBZ,EAAMa,KAAI,SAAAzC,G,OAAM,EAAA0C,EAAAC,iBAAgB3C,E,kDAjCrBoB,MAAAC,KAAAC,U,CAoDC,SAA3BgB,IACP,IAAMM,EAAQ7B,IAEd,OAAI6B,EAAQ,KACH,EACEA,EAAQ,IACV,EAEA,C,CAKe,SAAjB7B,IACP,OAAOtC,SAASoE,gBAAgBC,W,CAIsC,SAA/DP,EAAazE,EAAKiF,EAAMC,GAC/B,IAAMC,GAASF,EAAO,GAAKC,EACrBE,EAAMD,EAAQD,EAEpB,OADoBlF,EAAIqF,MAAMF,EAAOC,E,CAKa,SAA3CV,EAAmB1E,GAC1BU,EAAI4E,mBAAmB,YAAatF,EAAIuF,KAAK,KAC7C,IAAMC,EAAS7E,SAAS8E,iBAAiB,2BACpCjE,GAAS,EAATC,GAAS,EAATC,OAASlB,E,IAAd,QAAKmB,EAAAC,EAAa4D,EAAM1D,OAAAC,cAAnBP,GAAAG,EAAAC,EAASI,QAAAC,MAATT,GAAS,GAAT,IAAMkE,EAAN/D,EAASQ,MACe,SAAvBuD,EAAIvE,QAAQwE,SACdD,EAAIE,kBAAkBvD,YAAc,uBACpCqD,EAAIrE,UAAUoB,IAAI,Y,WAHjBhB,GAAS,EAATC,EAASY,C,aAATd,GAAS,MAATI,EAASW,QAATX,EAASW,Q,YAATd,E,MAAAC,C,GAyBA,SAASG,IACd,OAAOkB,C,CAnHkB8C,OAApBhF,iBAAiB,UAqGxB,YAEImC,EAAuB,KAAOC,KAAgB,KAC7CD,GAAuB,KACtBA,EAAsB,OACrBC,IAAe,KAAOA,KAAgB,OACxCD,GAAuB,MAAQC,IAAe,OAE/CE,G,IAvGJA,EAAqB2C,EAAAC,uB","sources":["src/js/news-list.js","src/js/library.js","src/js/favorite-btn-action.js"],"sourcesContent":["// ------------Lyosha, Yura, Dima--------------\nimport { getMostPopularArticles } from './newsApiService';\nimport { creatCardMarkup } from './creatCardMarkup';\nimport { onButtonFavorite } from './favorite-btn-action';\nimport { dadada } from './news-card';\nimport { loadAllFavorites } from './library';\n// import { includeFavoriteNew, excludeFavoriteNew } from './favorite';\n\nconst box = document.querySelector('.box-news');\n\nbox.addEventListener('click', onButtonFavorite);\nbox.addEventListener('click', onClickReadMore);\n\nlet currentDispleyWidth = checkWidth(); //текущая ширина вью порта\nlet arrCurrentNews = []; //копия массива поп новостей (или по категориям, или по серчу)\nlet page = 1;\nlet perPage = null; // текущая страница (для пагинации)\n\nwindow.addEventListener('resize', onResize);\n\n/*\nосновная ф-ция, создаем стартовую страницу, коллбеком передаем ф-цию \nкоторая возвращает норм. массив поп. новостей (или по категориям, или по серчу)\n*/\ncreateNewsCollection(getMostPopularArticles);\n\nasync function createNewsCollection(func) {\n  // проверяем пустой ли массив \"текущих\" новостей\n\n  if (arrCurrentNews.length === 0) {\n    arrCurrentNews = await func();\n    /* если нет - вызываем апи и заполняем массив \n    соответствующими новостями (по категориям или серчу)\n    */\n  }\n  perPage = cardsPerPage(); // замеряем ширину вью порта\n\n  const arrForMarkup = displayItems(arrCurrentNews, page, perPage); // массив для рендера на текущую страницу\n  // let cardMarkupArray = arrForMarkup.map(el => creatCardMarkup(el)); // массив готовой разметки карточек для рендера на текущую страницу\n\n  let array = [];\n\n  dadada(arrForMarkup);\n\n  function dadada(arr) {\n    //   const btn = document.querySelector('.box-news__favorite-btn');\n    const localArr = loadAllFavorites();\n    const newArr = arr.forEach(el => {\n      const local = localArr.some(item => el.id === item.id);\n      if (local) {\n        el.add = true;\n        array.push(el);\n      } else {\n        el.add = false;\n        array.push(el);\n      }\n    });\n  }\n\n  let cardMarkupArray = array.map(el => creatCardMarkup(el)); // массив готовой разметки карточек для рендера на текущую страницу\n\n  // if (currentDispleyWidth > 1280) {\n  //   cardMarkupArray.splice(2, 0, `<li class=\"box-weather__item box \"></li>`);\n  //   return;\n  // } else if (currentDispleyWidth > 768) {\n  //   cardMarkupArray.splice(1, 0, `<li class=\"box-weather__item box \"></li>`);\n  //   return;\n  // } else {\n  //   cardMarkupArray.splice(0, 0, `<li class=\"box-weather__item box \"></li>`);\n  // }\n\n  // // погода cardMarkupArray ('строка разменки погоды') splice(). но условие для мобилки!!!\n  renderBoxNewMarkup(cardMarkupArray); // рендер текущей страницы\n}\n\n// замеряем ширину вью порта и определяем сколько рендрерить\n// карточек на страницу, возвращаеи число для perPage\n\nfunction cardsPerPage() {\n  const width = checkWidth();\n\n  if (width > 1280) {\n    return 8;\n  } else if (width > 768) {\n    return 7;\n  } else {\n    return 4;\n  }\n}\n\n// ф-ци возвращае ширину вью порта\nfunction checkWidth() {\n  return document.documentElement.clientWidth;\n}\n\n// ф-ция возвращает массив карточек для рендера на текущую страницу (из текущуго массива arrCurrentNews)\nfunction displayItems(arr, page, perPage) {\n  const start = (page - 1) * perPage;\n  const end = start + perPage;\n  const paginatedEl = arr.slice(start, end);\n  return paginatedEl;\n}\n\n// ф-ция рендера текущих карточек на страницу и изменение кнопок\nfunction renderBoxNewMarkup(arr) {\n  box.insertAdjacentHTML('beforeend', arr.join(''));\n  const favBtn = document.querySelectorAll('.box-news__favorite-btn');\n  for (const btn of favBtn) {\n    if (btn.dataset.status === 'true') {\n      btn.firstElementChild.textContent = 'Remove from Favorite';\n      btn.classList.add('favorite');\n    }\n  }\n  // box.innnerHTML = arr.join('');\n}\n\n/* ф-ция следит за текущей шириной экрана. и если она вышла за брэкпоинты\nстраница рендерится заново для текущей ширины экрана\n*/\nfunction onResize() {\n  if (\n    (currentDispleyWidth < 768 && checkWidth() >= 768) ||\n    (currentDispleyWidth >= 768 &&\n      currentDispleyWidth < 1280 &&\n      (checkWidth() < 768 || checkWidth() >= 1280)) ||\n    (currentDispleyWidth >= 1280 && checkWidth() < 1280)\n  ) {\n    createNewsCollection();\n  }\n}\n\n// ф-ция возвращает текущий массив новостей\nexport function sendCurrentArray() {\n  return arrCurrentNews;\n}\n\n/*********************** button ********************************/\n\nfunction onClickReadMore(e) {\n  e.preventDefault();\n  if (e.target.tagName === 'A') {\n    let currentId = e.target.closest('li').dataset.id;\n    let currentLi = e.target.closest('li');\n    // console.log('currentId - ', currentId, 'currentLi - ', currentLi);\n\n    for (const el of arrCurrentNews) {\n      console.log('el - ', el);\n      if (el.id === currentId) {\n        // console.log('el.id - ', el.id);\n        console.log('Мы нашли ID и вызываем ф-цию READ (include...)');\n        currentLi.classList.add('show');\n        return;\n      }\n      console.log('Вышли из функции когда отправили данные');\n    }\n  }\n}\n","const FAVORITE_STORAGE_KEY = 'Favorite';\n\nexport function includeFavoriteNew(theNew) {\n  console.log(theNew);\n  try {\n    let curNewsArray = loadAllFavorites();\n    if (\n      typeof curNewsArray !== 'object' ||\n      Array.isArray(curNewsArray) === false\n    ) {\n      curNewsArray = [];\n      console.log(curNewsArray);\n    }\n\n    curNewsArray.unshift(theNew);\n    saveFavorites(curNewsArray);\n    return true;\n  } catch (error) {\n    console.error(error.message);\n    return false;\n  }\n}\n\nexport function excludeFavoriteNew(newId) {\n  try {\n    const curNewsArray = loadAllFavorites();\n    const foundIndex = curNewsArray.findIndex((elm, idx) => elm.id === newId);\n    curNewsArray.splice(foundIndex, 1);\n    saveFavorites(curNewsArray);\n    return true;\n  } catch (error) {\n    console.error(error.message);\n    return false;\n  }\n}\n\nexport function saveFavorites(arr) {\n  const msg = 'Wrong data to save: array with objects is expected.';\n  if (typeof arr !== 'object') {\n    console.log(msg);\n    return;\n  }\n  if (Array.isArray(arr) === false) {\n    console.log(msg);\n    return;\n  }\n  try {\n    const serializedState = JSON.stringify(arr);\n    localStorage.setItem(FAVORITE_STORAGE_KEY, serializedState);\n  } catch (error) {\n    console.error('Set state error: ', error.message);\n  }\n}\n\nexport function loadAllFavorites() {\n  try {\n    const serializedState = localStorage.getItem(FAVORITE_STORAGE_KEY);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error(error.message);\n  }\n}\n","export { onButtonFavorite };\nimport { sendCurrentArray as getArray } from './news-list';\nimport { includeFavoriteNew, excludeFavoriteNew } from './library';\n\nfunction onButtonFavorite(e) {\n  if (e.target.closest('BUTTON')) {\n    const favButton = e.target.closest('BUTTON');\n    const favId = favButton.closest('li').dataset.id;\n    const favP = favButton.querySelector('.box-news__favorite-p');\n    const favSvg = favButton.querySelector('.box-news__favorite-svg');\n\n    if (favButton.classList.contains('favorite')) {\n      offColorBtn(favButton, favId, favP, favSvg);\n    } else {\n      onColorBtn(favButton, favId, favP, favSvg);\n    }\n  }\n}\n\nfunction offColorBtn(favButton, favId, favP, favSvg) {\n  for (const el of getArray()) {\n    if (el.id === favId) {\n      const resultDel = excludeFavoriteNew(el.id);\n\n      // const resultDel = true;\n      if (resultDel) {\n        console.log('Удалил');\n        favButton.classList.remove('favorite');\n        favP.textContent = 'Add to Favorite';\n      }\n      return;\n    }\n  }\n}\n\nexport function onColorBtn(favButton, favId, favP, favSvg) {\n  for (const el of getArray()) {\n    if (el.id === favId) {\n      const resultAdd = includeFavoriteNew(el);\n\n      // const resultAdd = true;\n      if (resultAdd) {\n        console.log('Добавил');\n        favButton.classList.add('favorite');\n        favP.textContent = 'Remove from Favorite';\n      }\n      return;\n    }\n  }\n}\n"],"names":["$bpxeT","parcelRequire","$93effc6fc56091ad$var$FAVORITE_STORAGE_KEY","$93effc6fc56091ad$export$d1d03fba418fb01d","theNew","console","log","curNewsArray","$93effc6fc56091ad$export$c5cd7ad466e0200e","Array","isArray","unshift","$93effc6fc56091ad$export$ff4b822c9af62a71","error","message","$93effc6fc56091ad$export$c91e3aec03b75cd3","newId","foundIndex","findIndex","elm","idx","id","splice","arr","msg","serializedState","JSON","stringify","localStorage","setItem","getItem","undefined","parse","$3898d7ad328977d2$var$box","document","querySelector","addEventListener","e","target","closest","favButton","favId","dataset","favP","classList","contains","favSvg","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","$3898d7ad328977d2$export$1c6c476e905539da","Symbol","iterator","next","done","el","value","remove","textContent","err","return","$3c4913f05a59266d$var$offColorBtn","add","$3c4913f05a59266d$export$6eb251ffe5be33b4","preventDefault","tagName","currentId","currentLi","$3898d7ad328977d2$var$arrCurrentNews","$3898d7ad328977d2$var$currentDispleyWidth","$3898d7ad328977d2$var$checkWidth","$3898d7ad328977d2$var$perPage","$3898d7ad328977d2$var$createNewsCollection","func","$3898d7ad328977d2$var$_createNewsCollection","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","arrForMarkup","array","dadada1","localArr","forEach","some","item","push","length","_ctx","sent","$3898d7ad328977d2$var$cardsPerPage","$3898d7ad328977d2$var$displayItems","$3898d7ad328977d2$var$renderBoxNewMarkup","map","$iF1nq","creatCardMarkup","width","documentElement","clientWidth","page1","perPage1","start","end","slice","insertAdjacentHTML","join","favBtn","querySelectorAll","btn","status","firstElementChild","window","$ko9ms","getMostPopularArticles"],"version":3,"file":"index.c2904787.js.map"}