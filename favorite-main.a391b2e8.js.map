{"mappings":"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","sources":["src/js/library.js","src/js/read-library.js","src/js/creatCardMarkup.js","src/js/favorite.js"],"sourcesContent":["const FAVORITE_STORAGE_KEY = 'Favorite';\n\nexport function includeFavoriteNew(theNew) {\n  try {\n    let curNewsArray = loadAllFavorites();\n    if (\n      typeof curNewsArray !== 'object' ||\n      Array.isArray(curNewsArray) === false\n    ) {\n      curNewsArray = [];\n      console.log(curNewsArray);\n    }\n\n    curNewsArray.unshift(theNew);\n    saveFavorites(curNewsArray);\n    return true;\n  } catch (error) {\n    console.error(error.message);\n    return false;\n  }\n}\n\nexport function excludeFavoriteNew(newId) {\n  try {\n    const curNewsArray = loadAllFavorites();\n    const foundIndex = curNewsArray.findIndex((elm, idx) => elm.id === newId);\n    curNewsArray.splice(foundIndex, 1);\n    saveFavorites(curNewsArray);\n    return true;\n  } catch (error) {\n    console.error(error.message);\n    return false;\n  }\n}\n\nexport function saveFavorites(arr) {\n  const msg = 'Wrong data to save: array with objects is expected.';\n  if (typeof arr !== 'object') {\n    console.log(msg);\n    return;\n  }\n  if (Array.isArray(arr) === false) {\n    console.log(msg);\n    return;\n  }\n  try {\n    const serializedState = JSON.stringify(arr);\n    localStorage.setItem(FAVORITE_STORAGE_KEY, serializedState);\n  } catch (error) {\n    console.error('Set state error: ', error.message);\n  }\n}\n\nexport function loadAllFavorites() {\n  try {\n    const serializedState = localStorage.getItem(FAVORITE_STORAGE_KEY);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error(error.message);\n  }\n}\n","export function loadReadStorage() {\n  try {\n    const storageRead = localStorage.getItem('read');\n    return storageRead === null ? {} : JSON.parse(storageRead);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nexport function writeReadStorage(object) {\n  removeFromReadStorage(object);\n  const readObj = loadReadStorage();\n  const currentDate = getCurrentDate();\n  if (!readObj[currentDate]) {\n    readObj[currentDate] = [];\n  }\n  readObj[currentDate].push(object);\n\n  localStorage.setItem('read', JSON.stringify(readObj));\n}\n\nexport function removeFromReadStorage(obj) {\n  const readObj = loadReadStorage();\n  for (key of Object.keys(readObj)) {\n    const indexInArray = readObj[key].findIndex(item => item.id === obj.id);\n    if (indexInArray > -1) {\n      console.log(readObj[key]);\n      readObj[key].splice(indexInArray, 1);\n    }\n  }\n  localStorage.setItem('read', JSON.stringify(readObj));\n}\n\n\nexport function getCurrentDate() {\n  return new Date().toLocaleString().slice(0, 10).split('.').join('/');\n}\n\n// Прописать вместо ф-ций loadReadStorage, writeReadStorage функции Леши,\n//  которые работают с БД вместо localStorage.\n// Делаем инастал библиотеки npm install firebase\n","import { loadAllFavorites } from './library';\nimport { loadReadStorage } from './read-library';\n\nfunction creatCardMarkup(el) {\n  const { abstract, title, url, published_date, image_url, section, id } = el;\n\n  const flags = checkRead(el);\n\n  return `<li class=\"box-news__item ${\n    flags.read ? 'show' : ''\n  }\" data-id=\"${id}\">\n      <p class=\"box-news__section\">${section}</p>\n          <div class=\"box-news___wrap-reading\">\n            <span class=\"box-news__reading\">Alredy read</span>\n            <svg class=\"icon\" width=\"18\" height=\"18\">\n              <use href=\"#icon-check\"></use>\n            </svg> \n          </div>\n          <button class=\"box-news__favorite-btn ${flags.fav ? 'favorite' : ''}\">\n              <p class=\"box-news__favorite-p\"> ${\n                flags.fav ? 'Remove from Favorite' : 'Add to Favorite'\n              }</p>\n              <svg class=\"box-news__favorite-svg\" width=\"16\" height=\"16\"\">\n                <use href=\"#icon-heart\"></use>\n              </svg>\n            </button>\n          <article>\n            <div class=\"box-news__thumb\">\n              <img class=\"box-news__img\" src=\"${image_url}\" loading=\"lazy\" alt=\"${section}\" width='440'/>\n            </div>\n          <div class=\"box-news__wrap-title\">\n            <h2 class=\"box-news__titel\">\n              ${title}\n            </h2>\n          </div>\n          <div class=\"box-news__wrap-text\">\n            <p class=\"box-news__text\">\n              ${\n                abstract.length > 120\n                  ? abstract.slice(0, 110) + '...'\n                  : abstract\n              }\n            </p>\n          </div>\n          <div class=\"box-news__wrap\">\n            <p class=\"box-news__data\">${published_date}</p>\n            <a href=\"${url}\" class=\"box-news__link\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Read more</a>\n          </div>\n          </article>\n          <div class=\"overlay\"></div>\n        </li>`;\n}\n\nexport { creatCardMarkup };\n\nfunction checkRead(obj) {\n  let arrFav = loadAllFavorites() || [];\n\n  let objRead = loadReadStorage() || {};\n  let arrRead = Object.values(objRead).flat();\n\n  const answer = arrFav.find(item => obj.id === item.id);\n\n  const reply = arrRead.find(i => obj.id === i.id);\n  let result = [];\n\n  return (result = {\n    fav: answer ? true : false,\n    read: reply ? true : false,\n  });\n}\n","//------------Oleksiy Zhuravlev-----------;\nimport { excludeFavoriteNew, loadAllFavorites } from './library.js';\nimport { creatCardMarkup } from './creatCardMarkup';\nimport { writeReadStorage } from './read-library';\n\nconst box = document.querySelector('.box-news');\nconst footerEl = document.querySelector('.footer');\nconst headerEl = document.querySelector('.header');\n\nlet noResultsText = 'The favorite news list is empty';\n\nbox.addEventListener('click', onClick);\n\nfunction onClick(e) {\n  const curTargetClass = e.target.classList.value;\n\n  if (curTargetClass === 'box-news__favorite-p') {\n    const favButton = e.target.closest('BUTTON');\n    const favId = favButton.closest('li').dataset.id;\n\n    excludeFavoriteNew(favId);\n    box.innerHTML = '';\n    createPopularNewsCollection(loadAllFavorites());\n  }\n  //-----to Read\n  if (e.target.tagName === 'A') {\n    let currentId = e.target.closest('li').dataset.id;\n    let currentLi = e.target.closest('li');\n    const favArray = loadAllFavorites();\n    for (const el of favArray) {\n      if (el.id === currentId) {\n        writeReadStorage(el);\n        currentLi.classList.add('show');\n        return;\n      }\n    }\n  }\n}\n\n// ф-ци возвращае ширину вью порта\nfunction checkWidth() {\n  return document.documentElement.clientWidth;\n}\n\nfunction cardsPerPage() {\n  const width = checkWidth();\n\n  if (width > 1280) {\n    return 8;\n  } else if (width > 768) {\n    return 7;\n  } else {\n    return 4;\n  }\n}\n\n// ф-ция возвращает массив карточек для рендера на текущую страницу (из текущуго массива arrCurrentNews)\nfunction displayItems(arr, page, perPage) {\n  const start = (page - 1) * perPage;\n  const end = start + perPage;\n  const paginatedEl = arr.slice(start, end);\n  return paginatedEl;\n}\n\nfunction renderNoNews(noResultsText) {\n  const noNewsMarkUp = `<div class=\"no-results-wrap\"><p class=\"no-results-text\">${noResultsText}</p><span class=\"no-results-bgr\"></span></div>`;\n  box.innerHTML = noNewsMarkUp;\n}\n\nfunction createPopularNewsCollection(arr) {\n  if (typeof arr !== 'object') {\n    return;\n  }\n  if (Array.isArray(arr) === false) {\n    return;\n  }\n\n  let perPage = cardsPerPage(); // замеряем ширину вью порта\n  const arrCurrentNews = loadAllFavorites();\n  const arrForMarkup = displayItems(arrCurrentNews, (page = 1), perPage); // массив для рендера на текущую страницу\n  if (arrForMarkup.length === 0) {\n    footerEl.classList.add('footer-margin');\n    headerEl.classList.add('header-margin');\n    renderNoNews(noResultsText);\n  } else {\n    const cardMarkupArray = arrForMarkup.map(el => creatCardMarkup(el)); // массив готовой разметки карточек для рендера на текущую страницу\n\n    box.insertAdjacentHTML('beforeend', cardMarkupArray.join(''));\n  }\n}\n\ncreatePopularNewsCollection(loadAllFavorites());\n"],"names":["$93effc6fc56091ad$var$FAVORITE_STORAGE_KEY","$93effc6fc56091ad$export$c91e3aec03b75cd3","newId","curNewsArray","$93effc6fc56091ad$export$c5cd7ad466e0200e","foundIndex","findIndex","elm","idx","id","splice","$93effc6fc56091ad$export$ff4b822c9af62a71","error","console","message","arr","msg","Array","isArray","serializedState","JSON","stringify","localStorage","setItem","log","getItem","undefined","parse","$7c776d4421e955ca$export$fcf14f7a08ef2738","storageRead","$7c776d4421e955ca$export$3b92fc31f6d77cdf","object","obj","readObj","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Object","keys","Symbol","iterator","next","done","key","value","indexInArray","item","err","return","$7c776d4421e955ca$export$e89e3ada8d83d7a5","currentDate","Date","toLocaleString","slice","split","join","push","$d95d1fc007beb27b$export$c2172e452593faf6","el","arrFav","objRead","arrRead","answer","reply","abstract","title","url","published_date","image_url","section","flags","values","flat","find","i","fav","read","concat","length","$8bf2312eefa07846$var$box","document","querySelector","$8bf2312eefa07846$var$footerEl","$8bf2312eefa07846$var$headerEl","$8bf2312eefa07846$var$cardsPerPage","width","documentElement","clientWidth","$8bf2312eefa07846$var$createPopularNewsCollection","noNewsMarkUp","perPage","arrForMarkup","page","start","end","$8bf2312eefa07846$var$displayItems","classList","add","innerHTML","cardMarkupArray","map","insertAdjacentHTML","addEventListener","e","target","closest","dataset","tagName","currentId","currentLi","favArray"],"version":3,"file":"favorite-main.a391b2e8.js.map"}