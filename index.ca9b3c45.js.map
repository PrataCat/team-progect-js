{"mappings":"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","sources":["src/js/newsApiService.js","src/js/creatCardMarkup.js","src/js/library.js","src/js/news-list.js","src/js/favorite-btn-action.js"],"sourcesContent":["const API_KEY = 'xiA2oqSwY7oUdkxynOuoZzJzlQ7EJz4s';\n\nconst ArticleSearchEndpoint =\n  'https://api.nytimes.com/svc/search/v2/articlesearch.json';\nconst MostPopularEndpoint = 'https://api.nytimes.com/svc/mostpopular/v2/viewed';\nconst TimesWireEndpoint = 'https://api.nytimes.com/svc/news/v3/content';\n\nasync function getCategories() {\n  try {\n    const response = await fetch(\n      `${TimesWireEndpoint}/section-list.json?api-key=${API_KEY}`\n    );\n    const data = await response.json();\n\n    return data.results;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n// GET Category articles functions\n\nasync function fetchCategoryArticles(category, limit, offset) {\n  try {\n    const response = await fetch(\n      `${TimesWireEndpoint}/all/${category}.json?api-key=${API_KEY}&limit=${limit}&offset=${offset}`\n    );\n    const data = await response.json();\n\n    return data.results;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function getCategoryArticles(category, limit = 8, offset = 0) {\n  try {\n    const data = await fetchCategoryArticles(category, limit, offset);\n\n    const normalizedData = data.map(item => {\n      const { title, abstract, published_date, url, section, multimedia, uri } =\n        item;\n      const resultObj = {\n        title,\n        abstract,\n        published_date: dateFormat(published_date),\n        url,\n        section,\n        image_url: multimedia[2].url,\n        id: uri.split('/')[3],\n      };\n      return resultObj;\n    });\n    // console.log(normalizedData);\n    return normalizedData;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n// GET Most popular articles functions\n\nasync function fetchMostPopularArticles(days = 7) {\n  try {\n    if (![1, 7, 30].includes(days)) {\n      console.log('incorrect period');\n      return;\n    }\n    const response = await fetch(\n      `${MostPopularEndpoint}/${days}.json?api-key=${API_KEY}`\n    );\n    const data = await response.json();\n\n    return data.results;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function getMostPopularArticles(days = 7) {\n  try {\n    const data = await fetchMostPopularArticles(days);\n\n    const normalizedData = data.map(item => {\n      const { title, abstract, published_date, url, section, media, uri } =\n        item;\n      const image_url = media[0] ? media[0]['media-metadata'][2].url : '';\n      const resultObj = {\n        title,\n        abstract,\n        published_date: dateFormat(published_date),\n        url,\n        section,\n        image_url,\n        id: uri.split('/')[3],\n      };\n      return resultObj;\n    });\n    // console.log(normalizedData);\n    return normalizedData;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\n// GET Search articles functions\n\nasync function fetchSearchArticles(query, pub_date, page) {\n  try {\n    const pubDate = pub_date ? `&fq=pub_date:${pub_date}` : '';\n    const response = await fetch(\n      `${ArticleSearchEndpoint}?api-key=${API_KEY}&page=${page}&q=${query}${pubDate}`\n    );\n    const data = await response.json();\n\n    return data.response.docs;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function getSearchArticles(query, pub_date, page = 0) {\n  try {\n    const data = await fetchSearchArticles(query, pub_date, page);\n\n    const normalizedData = data.map(item => {\n      const {\n        headline,\n        abstract,\n        pub_date,\n        web_url,\n        subsection_name,\n        multimedia,\n        uri,\n      } = item;\n      const resultObj = {\n        title: headline.main,\n        abstract,\n        published_date: dateFormat(pub_date),\n        url: web_url,\n        section: subsection_name,\n        image_url:\n          'https://static01.nyt.com/' +\n          multimedia.find(item => item.subtype === 'mediumThreeByTwo440').url,\n        id: uri.split('/')[3],\n      };\n      return resultObj;\n    });\n    // console.log(normalizedData)\n    return normalizedData;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nfunction dateFormat(str) {\n  return new Date(str).toLocaleString().slice(0, 10).split('.').join('/');\n}\n\n// getCategories();\n// getMostPopularArticles();\n// getCategoryArticles('arts');\n// getSearchArticles('politics');\n\nexport {\n  getCategories,\n  getCategoryArticles,\n  getMostPopularArticles,\n  getSearchArticles,\n};\n","function creatCardMarkup(el) {\n  const { abstract, title, url, published_date, image_url, section, id } = el;\n\n  return `<li class=\"box-news__item\" data-id=\"${id}\">\n      <p class=\"box-news__section\">${section}</p>\n          <div class=\"box-news___wrap-reading\">\n            <span class=\"box-news__reading\">Alredy read</span>\n            <svg class=\"icon\" width=\"18\" height=\"18\">\n              <use href=\"#icon-check\"></use>\n            </svg> \n          </div>\n          <button id=\"favorite-btn\" class=\"box-news__favorite-btn\">\n              <p id=\"favorite-p\" class=\"box-news__favorite-p\">Add to Favorite</p>\n              <svg class=\"box-news__favorite-svg\" width=\"16\" height=\"16\" id=\"favorite-svg\">\n                <use href=\"#icon-heart\"></use>\n              </svg>\n            </button>\n          <article>\n            <div class=\"box-news__thumb\">\n              <img class=\"box-news__img\" src=\"${image_url}\" loading=\"lazy\" alt=\"${section}\" width='440'/>\n            </div>\n          <div class=\"box-news__wrap-title\">\n            <h2 class=\"box-news__titel\">\n              ${title}\n            </h2>\n          </div>\n          <div class=\"box-news__wrap-text\">\n            <p class=\"box-news__text\">\n              ${\n                abstract.length > 120\n                  ? abstract.slice(0, 110) + '...'\n                  : abstract\n              }\n            </p>\n          </div>\n          <div class=\"box-news__wrap\">\n            <p class=\"box-news__data\">${published_date}</p>\n            <a href=\"${url}\" class=\"box-news__link\" target=\"_blank\" rel=\"noopener noreferrer nofollow\">Read more</a>\n          </div>\n          </article>\n          <div class=\"overlay\"></div>\n        </li>`;\n}\n\nexport { creatCardMarkup };\n","const FAVORITE_STORAGE_KEY = 'Favorite';\n\nexport function includeFavoriteNew(theNew) {\n  console.log(theNew);\n  try {\n    let curNewsArray = loadAllFavorites();\n    if (\n      typeof curNewsArray !== 'object' ||\n      Array.isArray(curNewsArray) === false\n    ) {\n      curNewsArray = [];\n      console.log(curNewsArray);\n    }\n\n    curNewsArray.unshift(theNew);\n    saveFavorites(curNewsArray);\n    return true;\n  } catch (error) {\n    console.error(error.message);\n    return false;\n  }\n}\n\nexport function excludeFavoriteNew(newId) {\n  try {\n    const curNewsArray = loadAllFavorites();\n    const foundIndex = curNewsArray.findIndex((elm, idx) => elm.id === newId);\n    curNewsArray.splice(foundIndex, 1);\n    saveFavorites(curNewsArray);\n    return true;\n  } catch (error) {\n    console.error(error.message);\n    return false;\n  }\n}\n\nexport function saveFavorites(arr) {\n  const msg = 'Wrong data to save: array with objects is expected.';\n  if (typeof arr !== 'object') {\n    console.log(msg);\n    return;\n  }\n  if (Array.isArray(arr) === false) {\n    console.log(msg);\n    return;\n  }\n  try {\n    const serializedState = JSON.stringify(arr);\n    localStorage.setItem(FAVORITE_STORAGE_KEY, serializedState);\n  } catch (error) {\n    console.error('Set state error: ', error.message);\n  }\n}\n\nexport function loadAllFavorites() {\n  try {\n    const serializedState = localStorage.getItem(FAVORITE_STORAGE_KEY);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error(error.message);\n  }\n}\n","// ------------Lyosha, Yura, Dima--------------\nimport { getMostPopularArticles } from './newsApiService';\nimport { creatCardMarkup } from './creatCardMarkup';\nimport { onButtonFavorite } from './favorite-btn-action';\n// import { includeFavoriteNew, excludeFavoriteNew } from './favorite';\n\nconst box = document.querySelector('.box-news');\n\nbox.addEventListener('click', onButtonFavorite);\nbox.addEventListener('click', onClickReadMore);\n\nlet currentDispleyWidth = checkWidth(); //текущая ширина вью порта\nlet arrCurrentNews = []; //копия массива поп новостей (или по категориям, или по серчу)\nlet page = 1;\nlet perPage = null; // текущая страница (для пагинации)\n\nwindow.addEventListener('resize', onResize);\n\n/*\nосновная ф-ция, создаем стартовую страницу, коллбеком передаем ф-цию \nкоторая возвращает норм. массив поп. новостей (или по категориям, или по серчу)\n*/\ncreateNewsCollection(getMostPopularArticles);\n\nasync function createNewsCollection(func) {\n  // проверяем пустой ли массив \"текущих\" новостей\n\n  if (arrCurrentNews.length === 0) {\n    arrCurrentNews = await func();\n    /* если нет - вызываем апи и заполняем массив \n    соответствующими новостями (по категориям или серчу)\n    */\n  }\n  perPage = cardsPerPage(); // замеряем ширину вью порта\n\n  const arrForMarkup = displayItems(arrCurrentNews, page, perPage); // массив для рендера на текущую страницу\n  let cardMarkupArray = arrForMarkup.map(el => creatCardMarkup(el)); // массив готовой разметки карточек для рендера на текущую страницу\n\n  // if (currentDispleyWidth > 1280) {\n  //   cardMarkupArray.splice(2, 0, `<li class=\"box-weather__item box \"></li>`);\n  //   return;\n  // } else if (currentDispleyWidth > 768) {\n  //   cardMarkupArray.splice(1, 0, `<li class=\"box-weather__item box \"></li>`);\n  //   return;\n  // } else {\n  //   cardMarkupArray.splice(0, 0, `<li class=\"box-weather__item box \"></li>`);\n  // }\n\n  // // погода cardMarkupArray ('строка разменки погоды') splice(). но условие для мобилки!!!\n  renderBoxNewMarkup(cardMarkupArray); // рендер текущей страницы\n}\n\n// замеряем ширину вью порта и определяем сколько рендрерить\n// карточек на страницу, возвращаеи число для perPage\n\nfunction cardsPerPage() {\n  const width = checkWidth();\n\n  if (width > 1280) {\n    return 8;\n  } else if (width > 768) {\n    return 7;\n  } else {\n    return 4;\n  }\n}\n\n// ф-ци возвращае ширину вью порта\nfunction checkWidth() {\n  // let jo = document.documentElement.clientWidth;\n  // console.log(\"checkWidth  jo:\", jo)\n\n  return;\n}\ncheckWidth();\n\n// ф-ция возвращает массив карточек для рендера на текущую страницу (из текущуго массива arrCurrentNews)\nfunction displayItems(arr, page, perPage) {\n  const start = (page - 1) * perPage;\n  const end = start + perPage;\n  const paginatedEl = arr.slice(start, end);\n  return paginatedEl;\n}\n\n// ф-ция рендера текущих карточек на страницу\nfunction renderBoxNewMarkup(arr) {\n  box.insertAdjacentHTML('beforeend', arr.join(''));\n  // box.innnerHTML = arr.join('');\n}\n\n/* ф-ция следит за текущей шириной экрана. и если она вышла за брэкпоинты\nстраница рендерится заново для текущей ширины экрана\n*/\nfunction onResize() {\n  if (\n    (currentDispleyWidth < 768 && checkWidth() >= 768) ||\n    (currentDispleyWidth >= 768 &&\n      currentDispleyWidth < 1280 &&\n      (checkWidth() < 768 || checkWidth() >= 1280)) ||\n    (currentDispleyWidth >= 1280 && checkWidth() < 1280)\n  ) {\n    createNewsCollection();\n  }\n}\n\n// ф-ция возвращает текущий массив новостей\nexport function sendCurrentArray() {\n  return arrCurrentNews;\n}\n\n/*********************** button ********************************/\n\nfunction onClickReadMore(e) {\n  e.preventDefault();\n  if (e.target.tagName === 'A') {\n    let currentId = e.target.closest('li').dataset.id;\n    let currentLi = e.target.closest('li');\n    // console.log('currentId - ', currentId, 'currentLi - ', currentLi);\n\n    for (const el of arrCurrentNews) {\n      console.log('el - ', el);\n      if (el.id === currentId) {\n        // console.log('el.id - ', el.id);\n        console.log('Мы нашли ID и вызываем ф-цию READ (include...)');\n        currentLi.classList.add('show');\n        return;\n      }\n      console.log('Вышли из функции когда отправили данные');\n    }\n  }\n}\n\n","export { onButtonFavorite };\nimport { sendCurrentArray as getArray } from './news-list';\nimport { includeFavoriteNew, excludeFavoriteNew } from './library';\n\nfunction onButtonFavorite(e) {\n  if (e.target.closest('BUTTON')) {\n    const favButton = e.target.closest('BUTTON');\n    const favId = favButton.closest('li').dataset.id;\n    const favP = favButton.querySelector('.box-news__favorite-p');\n    const favSvg = favButton.querySelector('.box-news__favorite-svg');\n\n    if (favButton.classList.contains('favorite')) {\n      offColorBtn(favButton, favId, favP, favSvg);\n    } else {\n      onColorBtn(favButton, favId, favP, favSvg);\n    }\n  }\n}\n\nfunction offColorBtn(favButton, favId, favP, favSvg) {\n  for (const el of getArray()) {\n    if (el.id === favId) {\n      const resultDel = excludeFavoriteNew(el.id);\n\n      // const resultDel = true;\n      if (resultDel) {\n        console.log('Удалил');\n        favButton.classList.remove('favorite');\n        favP.classList.remove('favorite-p');\n        favSvg.classList.remove('favorite-svg');\n        favP.textContent = 'Add to Favorite';\n      }\n      return;\n    }\n  }\n}\n\nfunction onColorBtn(favButton, favId, favP, favSvg) {\n  for (const el of getArray()) {\n    if (el.id === favId) {\n      const resultAdd = includeFavoriteNew(el);\n\n      // const resultAdd = true;\n      if (resultAdd) {\n        console.log('Добавил');\n        favButton.classList.add('favorite');\n        favP.classList.add('favorite-p');\n        favSvg.classList.add('favorite-svg');\n        favP.textContent = 'Remove from Favorite';\n      }\n      return;\n    }\n  }\n}\n"],"names":["$af2b51ed280f3c7d$var$dateFormat","str","Date","toLocaleString","slice","split","join","$fb66df559654ca3c$export$c2172e452593faf6","el","abstract","title","url","published_date","image_url","section","id","length","$1cafa503bc57b7a0$export$d1d03fba418fb01d","theNew","console","log","curNewsArray","$1cafa503bc57b7a0$export$c5cd7ad466e0200e","Array","isArray","unshift","$1cafa503bc57b7a0$export$ff4b822c9af62a71","error","message","$1cafa503bc57b7a0$export$c91e3aec03b75cd3","newId","foundIndex","findIndex","elm","idx","splice","arr","msg","serializedState","JSON","stringify","localStorage","setItem","getItem","undefined","parse","$b2053f0c68d6ee69$var$box","document","querySelector","addEventListener","e","target","closest","favButton","favId","dataset","favP","favSvg","classList","contains","$b2053f0c68d6ee69$export$1c6c476e905539da","remove","textContent","$a6d83f3effd2e3e7$var$offColorBtn","add","$a6d83f3effd2e3e7$var$onColorBtn","preventDefault","tagName","currentId","currentLi","$b2053f0c68d6ee69$var$arrCurrentNews","$b2053f0c68d6ee69$var$perPage","async","$b2053f0c68d6ee69$var$createNewsCollection","func","width","$b2053f0c68d6ee69$var$checkWidth","$b2053f0c68d6ee69$var$cardsPerPage","arrForMarkup","page1","perPage1","start","end","$b2053f0c68d6ee69$var$displayItems","cardMarkupArray","map","insertAdjacentHTML","window","$b2053f0c68d6ee69$var$currentDispleyWidth","days","data","includes","response","fetch","json","results","$af2b51ed280f3c7d$var$fetchMostPopularArticles","item","media","uri"],"version":3,"file":"index.ca9b3c45.js.map"}